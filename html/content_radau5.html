<h2>RADAU5 Fortran 77 ODE Solver</h2>
<a href="http://www.unige.ch/~hairer/software.html">RADAU5</a>
is an ODE solver written by Ernst Hairer and Gerhard Wanner. 
<h3>The VFGEN RADAU5 Command</h3>
<p>
A Fortran 77 file that can be used with RADAU5 
is created by the command
<div class="mypre">$ vfgen radau5 vector_field_file.vf</div>
</p>
<p>
This command creates the Fortran file <b>[name]_rhs.f</b>,
where [name] is the name of the vector field given in the vector field file. 
The file contains the following
subroutines:
<ul>
<li><b>[name]_rhs</b> &nbsp;  The vector field function 
               (<b>r</b>ight <b>h</b>and <b>s</b>ide) </li>
<li><b>[name]_jac</b> &nbsp;  The Jacobian of the vector field </li>
<li><b>[name]_sol</b> &nbsp;  A simple output subroutine </li>
</ul>
</p>
<h4>Options</h4>
<table class="options">
<!--
<tr>
<td><b>func</b></td>
<td>
If the option <b>func=yes</b> is given,
VFGEN also converts any user-defined functions in the vector field file
into functions in the C file.  The names of the
functions will be the same as those given in the vector field file,
with the name of the vector field prepended.
<br />
<i>Default</i>: <b>func=no</b>
</td>
</tr>
-->
<tr>
<td>
<b>demo</b>
</td>
<td>
If the option <b>demo=yes</b> is given,
the file <b>[name]_dr5.f</b>
is also created.  This program provides
a sample driver for the RADAU5 subroutine.
The initial conditions and parameter values
are the default values defined in the vector
field file.
<br />
<i>Default</i>: <b>demo=no</b>
</td>
</tr>
</table>
<h4>Notes</h4>
<ul>
<li>I have tested the Fortran files generated by this
command with the GNU Fortran 77 compiler
<b>g77</b>, the GNU Fortran compiler <b>gfortran</b>,
and <b>fort77</b>, a Fortran compiler based on the Fortran-to-C
translator <b>f2c</b>. If you use a different compiler and have problems
with the code generated by VFGEN, please let me know. </li>
<li>Two non-standard features of the compiler are used:
the Fortran code is written in lower case, and the underscore
is used in variable names (e.g. <b>y_</b>).
The underscores are an easy way to avoid conflicts with variable names
that are taken from the vector field file.
(If you need code without underscores, let me know.)
</li>
</ul>
<h4>Example</h4>
<p>
Here is a sample vector field file: <a href="example_vf/vanderpol.vf">vanderpol.vf</a>.
<br>
The files created by
<div class="mypre">$ vfgen radau5:demo=yes vanderpol.vf</div>
are
<ul>
<li><a href="example_radau5/vanderpol_rhs.f">vanderpol_rhs.f</a></li>
<li><a href="example_radau5/vanderpol_dr5.f">vanderpol_dr5.f</a></li>
</ul>
</p>
<p>
The files <b>radau5.f</b> and <b>dc_lapack.f</b>
can be downloaded from the RADAU5 web site.
I will use the <b>gfortran</b> Fortran compiler.
In a Linux (or similar) system, in which the LAPACK library
is installed in a standard location, the following commands
will compile and run <b>vanderpol_dr5</b>.
(In Mac OSX 10.5, I replace <b>-llapack</b> with <b>-framework vecLib</b>.)
<div class="mypre">$ gfortran -c radau5.f <br />
$ gfortran -c dc_lapack.f <br />
$ gfortran -c vanderpol_rhs.f <br />
$ gfortran -c vanderpol_dr5.f <br />
$ gfortran vanderpol_dr5.o vanderpol_rhs.o radau5.o dc_lapack.o -llapack -o vanderpol_dr5
<br />
$ ./vanderpol_dr5 > vdp.csv <br />
</div>
The last command runs the program and sends the output to
<span class="tt">vdp.csv</span>.
Here is a plot of the data:
<center>
<div id="radau5_example_plot" style="width:600px;height:350px;"></div>
</center>
<script src="https://cdn.plot.ly/plotly-2.35.2.min.js" charset="utf-8"></script>
<script type="module">
import {data} from './example_radau5/plotly_data.js';
var plotter = document.getElementById('radau5_example_plot');
var layout = {
    title:'van der Pol',
    xaxis: {
        title: {
            text: 't'
        },
    },
};
Plotly.newPlot(plotter, data, layout);
</script>
</p>
